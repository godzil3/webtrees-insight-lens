<?php

declare(strict_types=1);

use Fisharebest\Webtrees\I18N;

/**
 * Tab 4: Activity Log
 *
 * @var string $noDataMessage
 */

?>
<!-- Authentication Summary -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Authentication Summary') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Successful logins and failed login attempts') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body" style="position: relative;">
        <canvas id="authSummaryChart" style="max-height: 300px; width: 100%;"></canvas>
        <div id="authSummaryChartNoData" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; pointer-events: none;">
            <p class="text-muted text-center" style="font-size: 16px; margin: 0;"><?= $noDataMessage ?></p>
        </div>
    </div>
</div>

<!-- Search Activity - Timeline -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Search Activity Timeline') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Number of searches performed over time') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body" style="position: relative;">
        <canvas id="searchTimelineChart" style="max-height: 300px; width: 100%;"></canvas>
        <div id="searchTimelineChartNoData" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; pointer-events: none;">
            <p class="text-muted text-center" style="font-size: 16px; margin: 0;"><?= $noDataMessage ?></p>
        </div>
    </div>
</div>

<!-- Search Terms Frequency -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Most Searched Terms') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Top 20 most frequently searched terms') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body" style="position: relative;">
        <canvas id="searchTermsChart" style="max-height: 300px; width: 100%;"></canvas>
        <div id="searchTermsChartNoData" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; pointer-events: none;">
            <p class="text-muted text-center" style="font-size: 16px; margin: 0;"><?= $noDataMessage ?></p>
        </div>
    </div>
</div>

<!-- Internal Communication Statistics -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Internal Messaging Activity') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Timeline of internal messages sent between users') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body" style="position: relative;">
        <canvas id="messageTimelineChart" style="max-height: 300px; width: 100%;"></canvas>
        <div id="messageTimelineChartNoData" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; pointer-events: none;">
            <p class="text-muted text-center" style="font-size: 16px; margin: 0;"><?= $noDataMessage ?></p>
        </div>
    </div>
</div>

<!-- User Communication Patterns -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Most Active Communicators') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Users with the most sent and received internal messages') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body" style="position: relative;">
        <canvas id="userMessageStatsChart" style="max-height: 300px; width: 100%;"></canvas>
        <div id="userMessageStatsChartNoData" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; pointer-events: none;">
            <p class="text-muted text-center" style="font-size: 16px; margin: 0;"><?= $noDataMessage ?></p>
        </div>
    </div>
</div>

<!-- Failed Login Attempts -->
<div class="card mb-4">
    <div class="card-header">
        <h3 class="card-title"><?= I18N::translate('Failed Login Attempts') ?></h3>
        <span class="wt-icon-help" title="<?= I18N::translate('Security monitoring - users/IPs with repeated failed login attempts') ?>">
            <i class="fas fa-question-circle fa-fw" aria-hidden="true"></i>
        </span>
    </div>
    <div class="card-body">
        <div id="failedLoginsData"></div>
    </div>
</div>
